FULL_FINAL.ipynb - блокнот с обучением бинарной и 6-классовой модели и экспериментами  
INFERENCE.ipynb - блокнот с инференсом решения  
models.py - модели  
utils.py - вспомогательные функции  
requirements.txt - версии библиотек  
public_data - данные с паблика  
models - модели  
AIIJC_FLASK_DEMO - сайт  
  
Для просчёта решения необходимо установить все библиотеки из requirements.txt и прогнать файл инференса




## ЭКГ-сигналы и искусственный интеллект
Для начала давайте немного разберёмся в методе электрокардиографии. Он заключается в представлении электрической активности сердца в виде электрокардиограммы. Первые ЭКГ-сигналы были записаны ещё в XIX веке французским физиком Габриэлем Липпманом, когда стало ясно, что сердце во время своей работы производит некоторое количество электричества. Со временем метод развивался и на данный момент является одним из ведущих способов определения сердечно-сосудистых заболеваний.

Электрокардиограмма представляет собой хронологическую последовательность разностей потенциалов между электродами, закрепленными на конечностях и груди человека. Наверное, все помнят кушетку и присоски в кабинете врача, которые надолго оставляют после себя следы. Эти разности потенциалов называются отведениями, чаще всего в диагностике используется 12 отведений – этакий золотой стандарт.

Важна также форма самой ЭКГ, которая определяется по 5 зубцам: P, Q, R, S и T. Они формируют интервалы различной формы и длины. Сигнал начинается с волны P, представляющей начало сердцебиения, за которой следует комплекс QRS, отражающий процесс удара сердца. После QRS идет волна T, символизирующая конец сердцебиения. Схематическое изображение этого процесса у отведения I нормального ЭКГ-сигнала показано ниже:
![image](https://github.com/Artsel288/MyocardPredictor/assets/80222124/5a68c5e7-b905-4fcc-b975-7d612971007b)


Измерение длин интервалов и их амплитуд позволяет оценить состояние сердечно-сосудистой системы и выявить возможные нарушения в ее работе.
Измерение длин интервалов и их амплитуд позволяет оценить состояние сердечно-сосудистой системы и выявить возможные нарушения в ее работе.
Помимо отведений, запись ЭКГ происходит с определённой частотой, которая измеряется в герцах (число измерений в секунду). В наборе данных, который мы подготовили для соревнования, частота записи равна 500 Герц (то есть, 500 измерений сигнала в секунду), по времени запись сигнала длится 10 секунд. Таким образом, каждая запись по пациенту включает 12x500x10 = 60 000 измерений. 

Стоит отметить, что область анализа электрокардиограмм методами ИИ является довольно обширной и активно исследуется – на сегодняшний день опубликовано большое количество работ на тему классификации, сегментации и даже генерации ЭКГ-сигналов. Также, недавно в рамках публичного бенчмарка MedBench мы запустили задачу multi-label классификации ЭКГ-сигналов. Данные для задачи взяли из публичного датасета PTB-XL и переразметили 3 тысячи записей с помощью ведущих врачей-кардиологов (по схеме консенсуса асессоров) согласно отечественному тезаурусу сердечных патологий.

Новая разметка предполагает более качественное и полное представление о сигналах, из которых удалось выделить 73 класса, описывающих наличие возможных сердечных патологий или служебно-технических характеристик сигнала. Соревновательная задача во многом основывается на этой работе.

Итоговая постановка звучала следующим образом: построить модель определения наличия и локализации инфаркта миокарда по ЭКГ-сигналу. 

Для этого из исходных 73 классов были выбраны относящиеся к целевой патологии 6 итоговых подклассов, описывающих возможную локализацию инфаркта миокарда, а именно, нижний, передне-перегородочный, перегородочный, передний, передне-боковой и боковой + класс “норма”. Итоговое распределение данных выглядело следующим образом:
![image](https://github.com/Artsel288/MyocardPredictor/assets/80222124/9fafcd5a-3cbe-41f7-85ce-a293a06d9aad)  
  
## Метрика, на основе которой решения участников сравнивались на лидербордах, была F1-мера. Она считается по формуле:  

Метрика, на основе которой решения участников сравнивались на лидербордах, была F1-мера. Она считается по формуле:  

![image](https://github.com/Artsel288/MyocardPredictor/assets/80222124/78fbe96f-4706-420a-88b4-f6da158815b8)  
  
где ![image](https://github.com/Artsel288/MyocardPredictor/assets/80222124/bb5c56ab-d7b3-452c-8ace-3f71d3e788d7)  
  
  Эта метрика позволяет оценить качество модели на датасетах с дисбалансом классов, сравнивая количество верно классифицированных объектов (TP или True Positives), ложноположительных (FP или False Positives) и ложноотрицательных (FN или False Negatives).  
  
В финальном этапе команды должны были решить более сложную задачу multi-label классификации, а именно предсказать наличие или отсутствие всех 7 классов. По итогу также проверялся код, использовался закрытый тест и была защита решения. Кроме этого участникам предлагалась возможность реализовать API, демонстрирующий итоговое решение команды, например, в виде телеграм-бота или веб-сервиса. За это начислялись бонусные баллы. По итогам этапа выбиралось три команды-победителя.  
  
В течение всего соревнования было проведено 4 раунда встреч с участниками: welcome-вебинар на старте, в котором рассказали о актуальности задачи; по ходу решения провели две полноценные консультации с командами, на которых слушали идеи ребят и давали технические оценки и советы; а также финальную защиту решений в конце соревнования.  
